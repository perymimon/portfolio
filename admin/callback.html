<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Decap CMS</title>
</head>
<body>
<script>
    // Get code from URL
    const code = new URLSearchParams(window.location.search).get('code');
    if (code) {
        // Send the code back to the opener window
        window.opener.postMessage(
            `authorization:github:success:${JSON.stringify({
                provider: 'github',
                code,
            })}`,
            window.location.origin
        );
        // Close the popup
        window.close();
    } else {
        console.error('No code found in URL');
        window.opener.postMessage(
            `authorization:github:error:${JSON.stringify({
                error: 'No code found in URL'
            })}`,
            window.location.origin
        );
        window.close();
    }
</script>
</body>
</html>