<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Decap CMS</title>

</head>
<body>
<script>
    // Get error information from the URL if present
    const params = new URLSearchParams(document.location.search);
    const error = params.get('error');
    const error_description = params.get('error_description');

    if (error) {
        console.error('Error during authentication:', error, error_description);
        // Redirect back to the admin page with error
        window.location.href = '/portfolio/admin/#error=' + encodeURIComponent(error_description || error);
    } else {
        // Handle successful authentication
        const hash = document.location.hash;
        if (hash) {
            // Parse hash parameters
            const token = hash.substring(1).split('&').find(p => p.startsWith('access_token=')).split('=')[1];
            
            if (token) {
                localStorage.setItem('netlify-cms-user', JSON.stringify({
                    token: { access_token: token },
                    provider: 'github'
                }));
                
                // Redirect back to the admin interface
                window.location.href = '/portfolio/admin/';
            }
        }
    }
</script>
<script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
</body>
</html>